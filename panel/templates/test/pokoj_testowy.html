{% load static %}
<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PolubiszTo.pl â€” PokÃ³j testowy</title>
<style>
  :root{
    --brand:#0b74ff; --ink:#0b1320; --muted:#5b6777;
    --bg:#f7faff; --line:#e6edff; --ok:#21c77a;
    --radius:16px;
  }
  *{box-sizing:border-box}
  html,body{
    margin:0; background:var(--bg); color:var(--ink);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  }
  body::before{
    content:""; position:fixed; inset:0; z-index:-1; pointer-events:none;
    background:
      radial-gradient(900px 320px at 10% -10%, rgba(11,116,255,.12), transparent),
      radial-gradient(700px 260px at 85% 0%, rgba(106,92,255,.10), transparent);
  }
  header{
    position:sticky;top:0;z-index:10;
    background:rgba(255,255,255,.86);
    backdrop-filter:saturate(1.1) blur(10px);
    border-bottom:1px solid var(--line);
  }
  .wrap{max-width:1140px;margin:0 auto;padding:12px 16px}
  .row{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit}
  .mark{
    width:40px;height:40px;border-radius:12px;background:var(--brand);
    display:grid;place-items:center;color:#fff;
    box-shadow:0 8px 22px rgba(11,116,255,.28);
  }
  .brand h1{margin:0;font-size:20px}
  .brand p{margin:0;color:var(--muted);font-size:12px}
  .status{display:flex;align-items:center;gap:8px;font-size:13px;color:#2a3956}
  .dot{
    width:10px;height:10px;border-radius:50%;
    background:var(--ok);box-shadow:0 0 0 4px rgba(33,199,122,.15);
  }
  .content{padding:24px 16px}
  .grid{
    display:grid;grid-template-columns:repeat(12,1fr);
    gap:14px;align-items:start;
  }
  .card{
    grid-column:span 8;background:#fff;border:1px solid var(--line);
    border-radius:var(--radius);padding:16px;
    box-shadow:0 16px 56px rgba(11,116,255,.10);
  }
  .side{
    grid-column:span 4;background:#fff;border:1px solid var(--line);
    border-radius:var(--radius);padding:16px;
    box-shadow:0 16px 56px rgba(11,116,255,.06);
  }
  @media(max-width:980px){
    .card,.side{grid-column:span 12}
  }
  h2{margin:0 0 8px}
  p{margin:6px 0;color:#2a3956}
  .btn{
    border:1px solid var(--line);background:#fff;
    padding:12px 14px;border-radius:12px;cursor:pointer;
    font-weight:700;text-decoration:none;color:inherit;
    display:inline-flex;align-items:center;gap:8px;
  }
  .btn.brand{
    background:var(--brand);color:#fff;border-color:transparent;
    box-shadow:0 10px 28px rgba(11,116,255,.18);
  }
  .list{list-style:none;padding:0;margin:10px 0 0}
  .list li{
    padding:8px 0;border-top:1px dashed var(--line);
    font-size:14px;color:#2a3956;
  }
  .list li:first-child{border-top:0}
  .pill{
    display:inline-flex;align-items:center;gap:8px;
    padding:6px 10px;border:1px solid var(--line);
    border-radius:999px;background:#fff;
    font-size:12px;color:#2a3956;
  }

  /* ====== LICZNIK AKTYWNOÅšCI ====== */
  .ai-timer{
    margin-top:14px;background:#fff;border:1px solid var(--line);
    border-radius:12px;padding:12px;box-shadow:0 10px 30px rgba(11,116,255,.08)
  }
  .ai-timer-row{display:flex;align-items:center;gap:8px;font-size:14px;color:#2a3956}
  .ai-timer .dot{width:10px;height:10px;border-radius:50%}
  .ai-timer-time{font-weight:800;font-size:22px;margin-top:6px}
  .ai-timer-ctrls{margin-top:8px;display:flex;gap:8px;flex-wrap:wrap}
  .ai-btn{border:1px solid var(--line);background:#fff;padding:8px 10px;border-radius:10px;cursor:pointer;font-weight:700}
  .ai-btn:hover{filter:brightness(0.98)}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="row">
      <a class="brand" href="#">
        <div class="mark" aria-hidden="true">
          <svg viewBox="0 0 48 48" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 16l20-8 20 8-20 8-20-8z" stroke="#fff"/>
            <path d="M12 20v7c0 2 6 5 12 5s12-3 12-5v-7" stroke="#dbe9ff"/>
            <circle cx="36" cy="10" r="3" fill="#dbe9ff" stroke="none"/>
          </svg>
        </div>
        <div>
          <h1>PolubiszTo.pl</h1>
          <p>PokÃ³j testowy</p>
        </div>
      </a>
      <div class="status"><span class="dot"></span> PokÃ³j aktywny â€¢ tryb testowy</div>
    </div>
  </div>
</header>

<main class="content">
  <div class="wrap">
    <div class="grid">
      <section class="card">
        <h2>Start: Strefa AI</h2>
        <p>To jest <b>pokÃ³j testowy</b>. Kliknij przycisk, by wejÅ›Ä‡ do <em>Strefy AI (podglÄ…d)</em> i zaczÄ…Ä‡ budowaÄ‡ ekosystem nauki: mentorzy 24/7, quizy adaptacyjne, kalkulator opÅ‚acalnoÅ›ci.</p>
        <p style="margin-top:12px">
          <a class="btn brand" href="{% url 'strefa_ai_home' %}">ðŸš€ WejdÅº do Strefy AI (test)</a>
        </p>
        <ul class="list">
          <li>W docelowej wersji ten przycisk bÄ™dzie wÅ‚Ä…czaÅ‚ licznik minut i rozliczanie.</li>
          <li>PoÅ‚Ä…czenie z gÅ‚osem i tablicÄ… doÅ‚oÅ¼ymy etapami.</li>
          <li>Testuj na telefonie i laptopie (responsywne).</li>
        </ul>

        <!-- === LICZNIK AKTYWNOÅšCI â€” START === -->
        <div class="ai-timer" id="aiTimerBox">
          <div class="ai-timer-row">
            <span class="dot" id="aiStatusDot" style="background:#ff5a5a"></span>
            <span id="aiStatusText">Nieaktywny</span>
          </div>
          <div class="ai-timer-time">
            Czas aktywnej sesji: <span id="aiActiveTime">00:00:00</span>
          </div>
          <div class="ai-timer-ctrls">
            <button class="ai-btn" id="aiReset">Reset</button>
          </div>
        </div>
        <!-- === LICZNIK AKTYWNOÅšCI â€” KONIEC === -->
      </section>

      <aside class="side">
        <h3 style="margin:0 0 6px">Plan wdroÅ¼enia</h3>
        <ul class="list">
          <li><span class="pill">DzieÅ„ 1â€“2</span> Czat AI (Lite) + ksiÄ™gowoÅ›Ä‡: kalkulator</li>
          <li><span class="pill">DzieÅ„ 3â€“4</span> GÅ‚os (Full) + limity czasu/saldo</li>
          <li><span class="pill">Tydz. 3â€“4</span> Tablica (AliBoard) â€“ oddzielny moduÅ‚</li>
        </ul>
        <h3 style="margin:12px 0 6px">Status</h3>
        <ul class="list">
          <li>âœ… Strefa AI â€” podglÄ…d gotowy</li>
          <li>ðŸŸ¡ Kalkulator â€” przeniesiemy do ksiÄ™gowoÅ›ci</li>
          <li>âšª Tablica â€” w przygotowaniu</li>
        </ul>
      </aside>
    </div>
  </div>
</main>

<script>
/* ====== LICZNIK AKTYWNOÅšCI (pauza po 30 s bezczynnoÅ›ci) ====== */
(function(){
  const IDLE_MS = 30000; // 30 s bezczynnoÅ›ci = pauza
  const dot = document.getElementById('aiStatusDot');
  const txt = document.getElementById('aiStatusText');
  const out = document.getElementById('aiActiveTime');
  const btnReset = document.getElementById('aiReset');

  let activeMs = parseInt(sessionStorage.getItem('ai_active_ms') || '0', 10);
  let lastActivity = Date.now();
  let visible = (document.visibilityState === 'visible');

  function hhmmss(ms){
    const s = Math.floor(ms/1000);
    const h = String(Math.floor(s/3600)).padStart(2,'0');
    const m = String(Math.floor((s%3600)/60)).padStart(2,'0');
    const ss= String(s%60).padStart(2,'0');
    return `${h}:${m}:${ss}`;
  }
  function updateTime(){ out.textContent = hhmmss(activeMs); }
  function updateStatus(isActive){
    if(isActive){ dot.style.background = 'var(--ok)'; txt.textContent='Aktywny'; }
    else{ dot.style.background = '#ff5a5a'; txt.textContent='Nieaktywny'; }
  }
  function poke(){ lastActivity = Date.now(); }

  // Zdarzenia aktywnoÅ›ci
  ['mousemove','keydown','touchstart','click','pointermove'].forEach(ev=>{
    window.addEventListener(ev, poke, {passive:true});
  });

  // WidocznoÅ›Ä‡ karty
  document.addEventListener('visibilitychange', ()=>{
    visible = (document.visibilityState === 'visible');
    poke();
  });

  // GÅ‚Ã³wna pÄ™tla 1 Hz
  setInterval(()=>{
    const now = Date.now();
    const isActive = visible && (now - lastActivity) < IDLE_MS;
    updateStatus(isActive);
    if(isActive){
      activeMs += 1000;
      sessionStorage.setItem('ai_active_ms', String(activeMs));
      updateTime();
    }
  }, 1000);

  // Reset
  btnReset.addEventListener('click', ()=>{
    activeMs = 0;
    sessionStorage.removeItem('ai_active_ms');
    updateTime();
  });

  // Publiczny hook â€” moÅ¼esz pobraÄ‡ ms i wysÅ‚aÄ‡ do backendu po zakoÅ„czeniu sesji
  window.aiTimerGetMs = ()=> activeMs;

  // Inicjalizacja
  updateTime();
})();
</script>
</body>
</html>
